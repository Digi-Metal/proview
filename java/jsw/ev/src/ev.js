"use strict";function PwrtStatus(t){this.sts=t,this.evenSts=function(){return t%2==0},this.oddSts=function(){return t%2==1},this.getSts=function(){return t}}var Pwr={eType_Boolean:98305,eType_Float32:98306,eType_Float64:98307,eType_Char:98308,eType_Int8:98309,eType_Int16:98310,eType_Int32:98311,eType_UInt8:98312,eType_UInt16:98313,eType_UInt32:98314,eType_Objid:98315,eType_Buffer:98316,eType_String:98317,eType_Enum:98318,eType_Struct:98319,eType_Mask:98320,eType_Array:98321,eType_Time:98322,eType_Text:98323,eType_AttrRef:98324,eType_UInt64:98325,eType_Int64:98326,eType_ClassId:98327,eType_TypeId:98328,eType_VolumeId:98329,eType_ObjectIx:98330,eType_RefId:98331,eType_DeltaTime:98332,eType_Status:98333,eType_NetStatus:98334,eType_CastId:98335,eType_ProString:98336,eType_DisableAttr:98337,eType_DataRef:98338,mPrv_RtRead:1,mPrv_RtWrite:2,mPrv_System:4,mPrv_Maintenance:8,mPrv_Process:16,mPrv_Instrument:32,mPrv_Operator1:64,mPrv_Operator2:128,mPrv_Operator3:256,mPrv_Operator4:512,mPrv_Operator5:1024,mPrv_Operator6:2048,mPrv_Operator7:4096,mPrv_Operator8:8192,mPrv_Operator9:16384,mPrv_Operator10:32768,mPrv_RtEventsAck:1<<18,mPrv_RtPlc:1<<19,mPrv_RtNavigator:1<<20,mPrv_DevRead:1<<21,mPrv_DevPlc:1<<22,mPrv_DevConfig:1<<23,mPrv_DevClass:1<<24,mPrv_RtEventsBlock:1<<25,mPrv_Administrator:1<<26,mPrv_SevRead:1<<27,mPrv_SevAdmin:1<<28,mAccess_RtRead:1,mAccess_RtWrite:2,mAccess_System:4,mAccess_Maintenance:8,mAccess_Process:16,mAccess_Instrument:32,mAccess_RtEventsBlock:1<<25,mAccess_RtEventsAck:1<<18,mAccess_RtPlc:1<<19,mAccess_RtNavigator:1<<20,mAccess_AllRt:35454975,mAccess_AllOperators:65472,mAccess_AllPwr:-1,mAdef_pointer:1,mAdef_array:2,mAdef_backup:4,mAdef_changelog:8,mAdef_state:16,mAdef_const:32,mAdef_rtvirtual:64,mAdef_devbodyref:128,mAdef_dynamic:256,mAdef_publicwrite:512,mAdef_noedit:1024,mAdef_invisible:2048,mAdef_refdirect:4096,mAdef_noinvert:8192,mAdef_noremove:16384,mAdef_rtdbref:32768,mAdef_private:65536,mAdef_class:131072,mAdef_superclass:262144,mAdef_buffer:524288,mAdef_nowbl:1048576,mAdef_alwayswbl:2097152,mAdef_disableattr:4194304,mAdef_rthide:8388608},Pwrb={mXttMethodsFlagsMask_IsConfigured:1,mXttOpMethodsMask_OpenGraph:1,mXttOpMethodsMask_OpenObjectGraph:2,mXttOpMethodsMask_OpenTrend:4,mXttOpMethodsMask_OpenHistory:8,mXttOpMethodsMask_OpenFast:16,mXttOpMethodsMask_Camera:32,mXttOpMethodsMask_HistEvent:64,mXttOpMethodsMask_BlockEvents:128,mXttOpMethodsMask_Help:256,mXttOpMethodsMask_Photo:512,mXttOpMethodsMask_Note:1024,mXttOpMethodsMask_ParentObjectGraph:2048,mXttMntMethodsMask_OpenObject:1,mXttMntMethodsMask_OpenTrace:2,mXttMntMethodsMask_RtNavigator:4,mXttMntMethodsMask_OpenCrossref:8,mXttMntMethodsMask_HelpClass:16,mXttMntMethodsMask_DataSheet:32,mXttMntMethodsMask_CircuitDiagram:64,mXttMntMethodsMask_Simulate:1<<31};function PwrtObjid(t,e){this.oix=e,this.vid=t}function PwrtAttrRef(){this.objid,this.offset,this.body,this.size,this.flags}function CdhrNumber(t,e){this.value=t,this.sts=e,this.evenSts=function(){return e%2==0},this.oddSts=function(){return e%2==1},this.getSts=function(){return e}}var CdhC={cUserVolMin:65793,cUserVolMax:16711422};function UserdataCbReturn(){this.userdata,this.row}function CliTable(t,e){this.command=t,this.qualifier=e}var CliC={SUCCESS:1,SYNTAX_ERROR:2,UNKNOWN_COMMAND:4,QUALNOTFOUND:6,VERB_VECT_SIZE:5,STATE_INIT:0,STATE_VERB:1,STATE_QUAL:2,STATE_QUALVALUE:3,STATE_SPACE:4,STATE_EQUAL:5,STATE_ERROR:6,STATE_QUOTE_VERB:7,STATE_QUOTE_QUALVALUE:8,STATE_QUALVALUE_EXACT:9,STATE_VERB_EXACT:10,TAB:"\t",SPACE:" "},MhC={eEvent_Ack:1,eEvent_Block:2,eEvent_Cancel:3,eEvent_CancelBlock:4,eEvent_Missing:5,eEvent_Reblock:6,eEvent_Return:7,eEvent_Unblock:8,eEvent_InfoSuccess:32,eEvent_Alarm:64,eEvent_MaintenanceAlarm:128,eEvent_SystemAlarm:256,eEvent_UserAlarm1:512,eEvent_UserAlarm2:1024,eEvent_UserAlarm3:2048,eEvent_UserAlarm4:4096,eEvent_Info:8192,eEventPrio_A:67,eEventPrio_B:66,eEventPrio_C:65,eEventPrio_D:64,mEventStatus_NotRet:1,mEventStatus_NotAck:2,mEventStatus_Block:4};function MhEventId(){this.nix,this.idx,this.birthTime}function MhEvent(){this.eventTime,this.eventText,this.eventName,this.eventFlags,this.eventStatus,this.eventId,this.targetId,this.eventType,this.object,this.supObject,this.eventMoreText,this.syncIdx}function Sub(){this.sts,this.refid,this.type,this.elements,this.name,this.value}function ObjectInfo(){this.objid,this.cid,this.has_children,this.name,this.description,this.classname,this.full_name,this.param1}function AttributeInfo(){this.name,this.type,this.size,this.flags,this.element,this.objid,this.full_name,this.classname}function MenuButton(){this.type,this.text,this.name,this.url}function OpwindMenuInfo(){this.title,this.text,this.enable_language,this.enable_login,this.enable_alarmlist,this.enable_eventlog,this.enable_navigator,this.disable_help,this.disable_proview,this.language,this.buttons=[]}function CrrInfo(){this.type,this.objid,this.name,this.classname}function GlowPieInfo(){this.sector_num,this.min_val,this.max_val}function GlowBarChartInfo(){this.bars,this.barsegments,this.min_value,this.max_value}function GlowTableInfo(){this.columns,this.rows,this.column_size=new Array(Glow.TABLE_MAX_COL)}function PendingData(t,e){this.func_cb=t,this.data=e}var GdhOp={GET_OP_SELF:1,GET_OP_METHOD_PLC:2,GET_OP_METHOD_OBJECTGRAPH:3,GET_OP_METHOD_GRAPH:4,GET_OP_METHOD_HELPCLASS:5};function Gdh(){var I=1,M=2,B=3,T=4,R=5,j=6,G=7,N=9,Q=10,D=15,V=25,L=26,Y=29,K=36,z=39,F=42,W=50,J=57,X=63,H=64,q=65,Z=66,$=67,tt=68;this.debug=!1,this.pending=[],this.sub=[],this.PORT=4448,this.ws=null,this.open_cb=null,this.close_cb=null,this.return_cb=null,this.next_id=1234,this.subscriptionCount=1,this.listSend=!1,this.init=function(){""===window.location.hostname?this.ws=new WebSocket("ws:127.0.0.1:4448"):this.ws=new WebSocket("ws://"+window.location.hostname+":4448"),this.ws.binaryType="arraybuffer",(this.ws.gdh=this).ws.onopen=function(t){null!==this.gdh.open_cb&&this.gdh.open_cb()},this.ws.onclose=function(){this.debug&&console.log("Socket closed"),null!==this.gdh.close_cb&&this.gdh.close_cb()},this.ws.onmessage=function(t){if("string"==typeof t.data)console.log("String message received",t,t.data);else if(t.data instanceof ArrayBuffer){var e=new DataView(t.data),n=e.getUint8(0),i=e.getUint32(1),s=e.getUint32(5);switch(n){case R:this.gdh.debug&&console.log("GetObjectInfoBoolean received");var a=e.getUint8(9);(0,this.gdh.pending[i].func_cb)(i,s,a),delete this.gdh.pending[i];break;case G:this.gdh.debug&&console.log("GetObjectInfoInt received");a=e.getUint32(9);(P=this.gdh.pending[i]).func_cb(i,P.data,s,a),delete this.gdh.pending[i];break;case j:this.gdh.debug&&console.log("GetObjectInfoFloat received");a=e.getFloat32(9);(P=this.gdh.pending[i]).func_cb(i,P.data,s,a),delete this.gdh.pending[i];break;case J:this.gdh.debug&&console.log("GetObjectInfoFloatArray received");var o=e.getInt32(9);a=new Array(o);d=13;for(var l=0;l<o;l++)a[l]=e.getFloat32(d),d+=4;(P=this.gdh.pending[i]).func_cb(i,P.data,s,a),delete this.gdh.pending[i];break;case I:this.gdh.debug&&console.log("SetObjectInfoBoolean received",i,s);break;case B:this.gdh.debug&&console.log("SetObjectInfoInt received",i,s);break;case M:this.gdh.debug&&console.log("SetObjectInfoFloat received",i,s);break;case T:this.gdh.debug&&console.log("SetObjectInfoString received",i,s);break;case N:this.gdh.debug&&console.log("ToggleObjectInfo received",i,s);break;case Q:this.gdh.debug&&console.log("RefObjectInfo received",i,s),delete this.gdh.pending[i];break;case D:this.gdh.debug&&console.log("UnrefObjectInfo received",i,s),delete this.gdh.pending[i];break;case L:this.gdh.debug&&console.log("RefObjectInfoList received",i,s),(0,this.gdh.pending[i].func_cb)(i,s),delete this.gdh.pending[i];break;case V:var h=9,r=e.getUint32(h);this.gdh.debug&&console.log("GetObjectRefInfoAll received",i,r),h+=4;for(l=0;l<r;l++){var A=e.getUint32(h);h+=4;var c=e.getUint32(h);h+=4;var g=this.gdh.sub[A];if(void 0===g)h+=c;else{switch(g.type){case Pwr.eType_Boolean:if(g.elements<=1)a=e.getUint8(h),h+=1;else{(f=c)!=g.elements&&console.log("Subscription size error",f,g.elements,A),a=new Array(f);for(var d=0;d<f;d++)a[d]=e.getUint8(h),h+=1}break;case Pwr.eType_Float32:if(g.elements<=1)a=e.getFloat32(h),h+=4;else{(f=c/4)!=g.elements&&console.log("Subscription size error",f,g.elements,A),a=new Array(f);for(d=0;d<f;d++)a[d]=e.getFloat32(h),h+=4}break;case Pwr.eType_Int8:case Pwr.eType_Int16:case Pwr.eType_Int32:case Pwr.eType_UInt8:case Pwr.eType_UInt16:case Pwr.eType_UInt32:case Pwr.eType_Status:case Pwr.eType_NetStatus:case Pwr.eType_Mask:case Pwr.eType_Enum:case GraphIfc.eType_Bit:if(g.elements<=1)a=e.getInt32(h),h+=4;else{(f=c/4)!=g.elements&&console.log("Subscription size error",f,g.elements,A),a=new Array(f);for(d=0;d<f;d++)a[d]=e.getInt32(h),h+=4}break;case Pwr.eType_String:case Pwr.eType_Time:case Pwr.eType_DeltaTime:case Pwr.eType_AttrRef:case Pwr.eType_Objid:if(g.elements<=1){var _=e.getInt16(h);h+=2;var u=new Uint8Array(_);for(d=0;d<_;d++)u[d]=e.getUint8(h++);a=String.fromCharCode.apply(null,u)}else{var f;(f=g.elements)!=g.elements&&console.log("Subscription size error",f,g.elements,A),a=new Array(f);for(var v=0;v<f;v++){_=e.getInt16(h);h+=2;for(u=new Uint8Array(_),d=0;d<_;d++)u[d]=e.getUint8(h++);a[v]=String.fromCharCode.apply(null,u)}}}this.gdh.sub[A].value=a}}if(void 0===this.gdh.pending[i]){console.log("** GetObjectRefInfoAll received removed",i);break}(0,this.gdh.pending[i].func_cb)(i,s),delete this.gdh.pending[i];break;case z:var m=[];h=9,r=e.getUint32(h);this.gdh.debug&&console.log("GetAllXttChildren received",i,r),console.log("GetAllXttChildren received",s,i,r),h+=4;for(l=0;l<r;l++){(b=new ObjectInfo).objid=new PwrtObjid,b.objid.vid=e.getUint32(h),h+=4,b.objid.oix=e.getUint32(h),h+=4,b.cid=e.getUint32(h),h+=4,b.has_children=0!==e.getUint16(h),h+=2;_=e.getUint16(h);h+=2;for(u=new Uint8Array(_),d=0;d<_;d++)u[d]=e.getUint8(h++);b.name=String.fromCharCode.apply(null,u);var w=e.getUint16(h);h+=2,u=new Uint8Array(w);for(d=0;d<w;d++)u[d]=e.getUint8(h++);b.description=String.fromCharCode.apply(null,u);var p=e.getUint16(h);h+=2,u=new Uint8Array(p);for(d=0;d<p;d++)u[d]=e.getUint8(h++);b.classname=String.fromCharCode.apply(null,u),m.push(b)}(P=this.gdh.pending[i]).func_cb(i,P.data,s,m),delete this.gdh.pending[i];break;case K:m=[],h=9,r=e.getUint32(h);this.gdh.debug&&console.log("GetAllClassAttributes received",i,r),h+=4;for(l=0;l<r;l++){(b=new AttributeInfo).type=e.getUint32(h),h+=4,b.flags=e.getUint32(h),h+=4,b.size=e.getUint16(h),h+=2,b.elements=e.getUint16(h),h+=2;_=e.getUint16(h);h+=2;for(u=new Uint8Array(_),d=0;d<_;d++)u[d]=e.getUint8(h++);b.name=String.fromCharCode.apply(null,u),_=e.getUint16(h),h+=2,u=new Uint8Array(_);for(d=0;d<_;d++)u[d]=e.getUint8(h++);b.classname=String.fromCharCode.apply(null,u),m.push(b)}(P=this.gdh.pending[i]).func_cb(i,P.data,s,m),delete this.gdh.pending[i];break;case X:case tt:case q:this.gdh.debug&&console.log("GetObject received",i,s);var b=null;if(0!=(1&s)){h=9;(b=new ObjectInfo).objid=new PwrtObjid,b.objid.vid=e.getUint32(h),h+=4,b.objid.oix=e.getUint32(h),h+=4,b.cid=e.getUint32(h),h+=4,b.has_children=0!==e.getUint16(h),h+=2;_=e.getUint16(h);h+=2;for(u=new Uint8Array(_),d=0;d<_;d++)u[d]=e.getUint8(h++);b.name=String.fromCharCode.apply(null,u),_=e.getUint16(h),h+=2,u=new Uint8Array(_);for(d=0;d<_;d++)u[d]=e.getUint8(h++);b.fullname=String.fromCharCode.apply(null,u);p=e.getUint16(h);h+=2,u=new Uint8Array(p);for(d=0;d<p;d++)u[d]=e.getUint8(h++);b.classname=String.fromCharCode.apply(null,u);w=e.getUint16(h);h+=2,u=new Uint8Array(w);for(d=0;d<w;d++)u[d]=e.getUint8(h++);b.description=String.fromCharCode.apply(null,u);var E=e.getUint16(h);h+=2,u=new Uint8Array(E);for(d=0;d<E;d++)u[d]=e.getUint8(h++);b.param1=String.fromCharCode.apply(null,u)}(P=this.gdh.pending[i]).func_cb(i,P.data,s,b),delete this.gdh.pending[i];break;case F:if(0!=(1&s)){h=9,m=[],r=e.getUint16(h);h+=2,this.gdh.debug&&console.log("CrrSignal received",i,r);for(l=0;l<r;l++){(b=new CrrInfo).type=e.getUint16(h),h+=2,b.objid=new PwrtObjid,b.objid.vid=e.getUint32(h),h+=4,b.objid.oix=e.getUint32(h),h+=4;_=e.getUint16(h);h+=2;for(u=new Uint8Array(_),d=0;d<_;d++)u[d]=e.getUint8(h++);b.name=String.fromCharCode.apply(null,u);p=e.getUint16(h);h+=2,u=new Uint8Array(p);for(d=0;d<p;d++)u[d]=e.getUint8(h++);b.classname=String.fromCharCode.apply(null,u),m.push(b)}}(P=this.gdh.pending[i]).func_cb(i,P.data,s,m),delete this.gdh.pending[i];break;case H:m=new OpwindMenuInfo,h=9;if(this.gdh.debug&&console.log("GetOpwindMenu received",i,r),console.log("GetOpwindMenu received",s,i),1&s){_=e.getUint16(h);h+=2;for(u=new Uint8Array(_),d=0;d<_;d++)u[d]=e.getUint8(h++);m.title=String.fromCharCode.apply(null,u),_=e.getUint16(h),h+=2,u=new Uint8Array(_);for(d=0;d<_;d++)u[d]=e.getUint8(h++);m.text=String.fromCharCode.apply(null,u),m.enable_language=e.getUint32(h),h+=4,m.enable_login=e.getUint32(h),h+=4,m.enable_alarmlist=e.getUint32(h),h+=4,m.enable_eventlog=e.getUint32(h),h+=4,m.enable_navigator=e.getUint32(h),h+=4,m.disable_help=e.getUint32(h),h+=4,m.disable_proview=e.getUint32(h),h+=4,m.language=e.getUint32(h),h+=4;var x=e.getUint16(h);h+=2;for(l=0;l<x;l++){var C=new MenuButton;C.type=e.getUint32(h),h+=4,_=e.getUint16(h),h+=2,u=new Uint8Array(_);for(d=0;d<_;d++)u[d]=e.getUint8(h++);C.text=String.fromCharCode.apply(null,u),_=e.getUint16(h),h+=2,u=new Uint8Array(_);for(d=0;d<_;d++)u[d]=e.getUint8(h++);C.name=String.fromCharCode.apply(null,u),_=e.getUint16(h),h+=2,u=new Uint8Array(_);for(d=0;d<_;d++)u[d]=e.getUint8(h++);C.url=String.fromCharCode.apply(null,u),m.buttons.push(C)}}(P=this.gdh.pending[i]).func_cb(i,P.data,s,m),delete this.gdh.pending[i];break;case Y:h=9;this.gdh.debug&&console.log("Check user received",i,r),console.log("Check user received",s,i);var y=0;1&s&&(y=e.getUint32(h),h+=4),(P=this.gdh.pending[i]).func_cb(i,P.data,s,y),delete this.gdh.pending[i];break;case W:if(1&s){h=9,_=e.getUint16(h);h+=2;for(u=new Uint8Array(_),d=0;d<_;d++)u[d]=e.getUint8(h++);var O=String.fromCharCode.apply(null,u)}(P=this.gdh.pending[i]).func_cb(i,P.data,s,O),delete this.gdh.pending[i];break;case Z:m=[],h=9,r=e.getUint32(h);this.gdh.debug&&console.log("MhSync received",i,r),h+=4;for(l=0;l<r;l++){t=new MhEvent;var U=e.getUint16(h);h+=2;for(u=new Uint8Array(U),d=0;d<U;d++)u[d]=e.getUint8(h++);t.eventTime=String.fromCharCode.apply(null,u),U=e.getUint16(h),h+=2,u=new Uint8Array(U);for(d=0;d<U;d++)u[d]=e.getUint8(h++);t.eventText=String.fromCharCode.apply(null,u),U=e.getUint16(h),h+=2,u=new Uint8Array(U);for(d=0;d<U;d++)u[d]=e.getUint8(h++);t.eventName=String.fromCharCode.apply(null,u),t.eventFlags=e.getUint32(h),h+=4,t.eventStatus=e.getUint32(h),h+=4,t.eventPrio=e.getUint32(h),h+=4,t.eventId=new MhEventId,t.eventId.nix=e.getUint32(h),h+=4,t.eventId.idx=e.getUint32(h),h+=4,U=e.getUint16(h),h+=2,u=new Uint8Array(U);for(d=0;d<U;d++)u[d]=e.getUint8(h++);t.eventId.birthTime=String.fromCharCode.apply(null,u),t.targetId=new MhEventId,t.targetId.nix=e.getUint32(h),h+=4,t.targetId.idx=e.getUint32(h),h+=4,U=e.getUint16(h),h+=2,u=new Uint8Array(U);for(d=0;d<U;d++)u[d]=e.getUint8(h++);t.targetId.birthTime=String.fromCharCode.apply(null,u),t.eventType=e.getUint32(h),h+=4;var S=new PwrtObjid(0,0);S.vid=e.getUint32(h),h+=4,S.oix=e.getUint32(h),h+=4,t.object=new PwrtAttrRef,t.object.objid=S,t.object.offset=e.getUint32(h),h+=4,t.object.body=e.getUint32(h),h+=4,t.object.size=e.getUint32(h),h+=4,t.object.flags=e.getUint32(h),h+=4;var k=new PwrtObjid(0,0);k.vid=e.getUint32(h),h+=4,k.oix=e.getUint32(h),h+=4,t.supObject=new PwrtAttrRef,t.supObject.objid=k,t.supObject.offset=e.getUint32(h),h+=4,t.supObject.body=e.getUint32(h),h+=4,t.supObject.size=e.getUint32(h),h+=4,t.supObject.flags=e.getUint32(h),h+=4,U=e.getUint16(h),h+=2,u=new Uint8Array(U);for(d=0;d<U;d++)u[d]=e.getUint8(h++);t.eventMoreText=String.fromCharCode.apply(null,u),t.syncIdx=e.getUint32(h),h+=4,m.push(t)}(P=this.gdh.pending[i]).func_cb(i,P.data,s,m),delete this.gdh.pending[i];break;case $:var P;(P=this.gdh.pending[i]).func_cb(i,P.data,s),delete this.gdh.pending[i];break;default:console.log("Unknown message type")}}}},this.getObjectInfoBoolean=function(t,e){this.return_cb=e;var n=new Uint8Array(t.length+6);n[0]=R,n[2]=255&this.next_id,n[3]=this.next_id>>8&255,n[4]=this.next_id>>16&255,n[5]=this.next_id>>24&255;for(var i=0;i<t.length;i++)n[i+6]=t.charCodeAt(i);this.pending[this.next_id]=new PendingData(e,null),this.ws.send(n),this.next_id++},this.getObjectInfoInt=function(t,e,n){this.return_cb=e;var i=new Uint8Array(t.length+6);i[0]=G,i[2]=255&this.next_id,i[3]=this.next_id>>8&255,i[4]=this.next_id>>16&255,i[5]=this.next_id>>24&255;for(var s=0;s<t.length;s++)i[s+6]=t.charCodeAt(s);this.pending[this.next_id]=new PendingData(e,n),this.ws.send(i),this.next_id++},this.getObjectInfoFloat=function(t,e,n){this.return_cb=e;var i=new Uint8Array(t.length+6);i[0]=j,i[2]=255&this.next_id,i[3]=this.next_id>>8&255,i[4]=this.next_id>>16&255,i[5]=this.next_id>>24&255;for(var s=0;s<t.length;s++)i[s+6]=t.charCodeAt(s);this.pending[this.next_id]=new PendingData(e,n),this.ws.send(i),this.next_id++},this.getObjectInfoFloatArray=function(t,e,n,i){this.return_cb=n;var s=new Uint8Array(t.length+10);s[0]=J,s[2]=255&this.next_id,s[3]=this.next_id>>8&255,s[4]=this.next_id>>16&255,s[5]=this.next_id>>24&255,s[6]=255&e,s[7]=e>>8&255,s[8]=e>>16&255,s[9]=e>>24&255;for(var a=0;a<t.length;a++)s[a+10]=t.charCodeAt(a);this.pending[this.next_id]=new PendingData(n,i),this.ws.send(s),this.next_id++},this.refObjectInfo=function(t,e,n){var i=new Sub;if(i.name=t,i.refid=this.subscriptionCount,i.type=e,i.elements=n,this.sub[this.subscriptionCount]=i,this.subscriptionCount++,this.listSent){var s;s=12+i.name.length;var a=new Uint8Array(s+10);a[0]=Q,a[2]=255&this.next_id,a[3]=this.next_id>>8&255,a[4]=this.next_id>>16&255,a[5]=this.next_id>>24&255,this.debug&&console.log("RefObjectInfo: ",i.refid);var o=6;a[o++]=255&i.refid,a[o++]=i.refid>>8&255,a[o++]=i.refid>>16&255,a[o++]=i.refid>>24&255,a[o++]=255&i.elements,a[o++]=i.elements>>8&255,a[o++]=i.elements>>16&255,a[o++]=i.elements>>24&255,a[o++]=255&i.name.length,a[o++]=i.name.length>>8&255,a[o++]=i.name.length>>16&255,a[o++]=i.name.length>>24&255;for(var l=0;l<i.name.length;l++)a[o++]=i.name.charCodeAt(l);return this.pending[this.next_id]=new PendingData(this.refObjectInfoReply,null),this.debug&&console.log("Sending RefObjectInfo",this.next_id,s,o),this.ws.send(a),this.next_id++,i.refid}return i.refid},this.refObjectInfoReply=function(t,e){this.debug&&console.log("refObjectInfoReply",t,e)},this.unrefObjectInfo=function(t){var e=new Uint8Array(14);e[0]=D,e[2]=255&this.next_id,e[3]=this.next_id>>8&255,e[4]=this.next_id>>16&255,e[5]=this.next_id>>24&255,this.debug&&console.log("UnrefObjectInfo: ",t);var n=6;e[n++]=255&t,e[n++]=t>>8&255,e[n++]=t>>16&255,e[n++]=t>>24&255,this.pending[this.next_id]=new PendingData(this.unrefObjectInfoReply,null),this.debug&&console.log("Sending UnrefObjectInfo",this.next_id,4,10,t),this.ws.send(e),this.next_id++,delete this.sub[t]},this.refObjectInfoList=function(t){var e=0,n=0;for(var i in this.return_cb=t,this.sub)e+=12+this.sub[i].name.length,n++;var s=new Uint8Array(e+10);s[0]=L,s[2]=255&this.next_id,s[3]=this.next_id>>8&255,s[4]=this.next_id>>16&255,s[5]=this.next_id>>24&255,s[6]=255&n,s[7]=n>>8&255,s[8]=n>>16&255,s[9]=n>>24&255;var a=10;for(var i in this.sub)if(0!==i){this.debug&&console.log("RefObjectInfoList: ",this.sub[i].refid),s[a++]=255&this.sub[i].refid,s[a++]=this.sub[i].refid>>8&255,s[a++]=this.sub[i].refid>>16&255,s[a++]=this.sub[i].refid>>24&255,s[a++]=255&this.sub[i].elements,s[a++]=this.sub[i].elements>>8&255,s[a++]=this.sub[i].elements>>16&255,s[a++]=this.sub[i].elements>>24&255,s[a++]=255&this.sub[i].name.length,s[a++]=this.sub[i].name.length>>8&255,s[a++]=this.sub[i].name.length>>16&255,s[a++]=this.sub[i].name.length>>24&255;for(var o=0;o<this.sub[i].name.length;o++)s[a++]=this.sub[i].name.charCodeAt(o)}this.pending[this.next_id]=new PendingData(t,null),this.debug&&console.log("Sending RefObjectInfoList",this.next_id,e,a,this.next_id),this.ws.send(s),this.next_id++,this.listSent=!0},this.refObjectInfoListReply=function(t,e){this.debug&&console.log("refObjectInfoListReply",t,e)},this.getRefObjectInfoAll=function(t){var e=new Uint8Array(6);e[0]=V,e[2]=255&this.next_id,e[3]=this.next_id>>8&255,e[4]=this.next_id>>16&255,e[5]=this.next_id>>24&255,this.pending[this.next_id]=new PendingData(t,null),this.debug&&console.log("Sending getRefObjectInfoAll",this.next_id),this.ws.send(e),this.next_id++},this.getRefObjectInfoAllReply=function(t,e){this.debug&&console.log("getRefObjectInfoAllReply",t,e)},this.getObjectRefInfo=function(t){return this.debug&&console.log("getObjectRefInfo",t,this.sub[t].value),this.sub[t].value},this.setObjectInfoBoolean=function(t,e){var n=new Uint8Array(12+t.length);n[0]=I,n[2]=255&this.next_id,n[3]=this.next_id>>8&255,n[4]=this.next_id>>16&255,n[5]=this.next_id>>24&255,n[6]=255&e,n[7]=e>>8&255,n[8]=e>>16&255,n[9]=e>>24&255,n[10]=255&t.length,n[11]=t.length>>8&255;for(var i=12,s=0;s<t.length;s++)n[i++]=t.charCodeAt(s);return this.ws.send(n),this.debug&&console.log("Sending setObjectInfoBoolean",this.next_id,t,e),this.next_id++,new PwrtStatus(1)},this.setObjectInfoInt=function(t,e){var n=new Uint8Array(12+t.length);n[0]=B,n[2]=255&this.next_id,n[3]=this.next_id>>8&255,n[4]=this.next_id>>16&255,n[5]=this.next_id>>24&255,n[6]=255&e,n[7]=e>>8&255,n[8]=e>>16&255,n[9]=e>>24&255,n[10]=255&t.length,n[11]=t.length>>8&255;for(var i=12,s=0;s<t.length;s++)n[i++]=t.charCodeAt(s);return this.ws.send(n),this.debug&&console.log("Sending setObjectInfoInt",this.next_id,t,e),this.next_id++,new PwrtStatus(1)},this.setObjectInfoFloat=function(t,e){var n=new Uint8Array(12+t.length);n[0]=M,n[2]=255&this.next_id,n[3]=this.next_id>>8&255,n[4]=this.next_id>>16&255,n[5]=this.next_id>>24&255;var i=new ArrayBuffer(4);new Float32Array(i)[0]=e;var s=new Uint8Array(i);n[6]=s[0],n[7]=s[1],n[8]=s[2],n[9]=s[3],n[10]=255&t.length,n[11]=t.length>>8&255;for(var a=12,o=0;o<t.length;o++)n[a++]=t.charCodeAt(o);return this.ws.send(n),this.debug&&console.log("Sending setObjectInfoFloat",this.next_id,t,e),this.next_id++,new PwrtStatus(1)},this.setObjectInfoString=function(t,e){var n,i=new Uint8Array(10+e.length+t.length);i[0]=T,i[2]=255&this.next_id,i[3]=this.next_id>>8&255,i[4]=this.next_id>>16&255,i[5]=this.next_id>>24&255,i[6]=255&e.length,i[7]=e.length>>8&255;var s=8;for(n=0;n<e.length;n++)i[s++]=e.charCodeAt(n);for(i[s++]=255&t.length,i[s++]=t.length>>8&255,n=0;n<t.length;n++)i[s++]=t.charCodeAt(n);return this.ws.send(i),this.debug&&console.log("Sending setObjectInfoString",this.next_id,t,e),this.next_id++,new PwrtStatus(1)},this.toggleObjectInfo=function(t){var e=new Uint8Array(8+t.length);e[0]=N,e[2]=255&this.next_id,e[3]=this.next_id>>8&255,e[4]=this.next_id>>16&255,e[5]=this.next_id>>24&255,e[6]=255&t.length,e[7]=t.length>>8&255;for(var n=8,i=0;i<t.length;i++)e[n++]=t.charCodeAt(i);return this.ws.send(e),this.debug&&console.log("Sending toggleObjectInfoBoolean",this.next_id,t,value),this.next_id++,new PwrtStatus(1)},this.getAllXttChildren=function(t,e,n){var i=new Uint8Array(14);i[0]=z,i[2]=255&this.next_id,i[3]=this.next_id>>8&255,i[4]=this.next_id>>16&255,i[5]=this.next_id>>24&255,i[6]=255&t.vid,i[7]=t.vid>>8&255,i[8]=t.vid>>16&255,i[9]=t.vid>>24&255,i[10]=255&t.oix,i[11]=t.oix>>8&255,i[12]=t.oix>>16&255,i[13]=t.oix>>24&255,this.pending[this.next_id]=new PendingData(e,n),this.debug&&console.log("Sending getAllXttChildren",this.next_id),this.ws.send(i),this.next_id++},this.getAllClassAttributes=function(t,e,n,i){var s=new Uint8Array(18);s[0]=K,s[2]=255&this.next_id,s[3]=this.next_id>>8&255,s[4]=this.next_id>>16&255,s[5]=this.next_id>>24&255,s[6]=255&t,s[7]=t>>8&255,s[8]=t>>16&255,s[9]=t>>24&255,s[10]=255&e.vid,s[11]=e.vid>>8&255,s[12]=e.vid>>16&255,s[13]=e.vid>>24&255,s[14]=255&e.oix,s[15]=e.oix>>8&255,s[16]=e.oix>>16&255,s[17]=e.oix>>24&255,this.pending[this.next_id]=new PendingData(n,i),this.debug&&console.log("Sending getAllClassAttributes",this.next_id,t,e.vid,e.oix),this.ws.send(s),this.next_id++},this.getObject=function(t,e,n,i){var s=new Uint8Array(16);s[0]=X,s[2]=255&this.next_id,s[3]=this.next_id>>8&255,s[4]=this.next_id>>16&255,s[5]=this.next_id>>24&255,s[6]=255&e,s[7]=e>>8&255,s[8]=255&t.vid,s[9]=t.vid>>8&255,s[10]=t.vid>>16&255,s[11]=t.vid>>24&255,s[12]=255&t.oix,s[13]=t.oix>>8&255,s[14]=t.oix>>16&255,s[15]=t.oix>>24&255,this.pending[this.next_id]=new PendingData(n,i),this.debug&&console.log("Sending getObject",this.next_id,t.vid,t.oix),this.ws.send(s),this.next_id++},this.getObjectFromAref=function(t,e,n,i){var s=new Uint8Array(32);s[0]=tt,s[2]=255&this.next_id,s[3]=this.next_id>>8&255,s[4]=this.next_id>>16&255,s[5]=this.next_id>>24&255,s[6]=255&e,s[7]=e>>8&255,s[8]=255&t.objid.vid,s[9]=t.objid.vid>>8&255,s[10]=t.objid.vid>>16&255,s[11]=t.objid.vid>>24&255,s[12]=255&t.objid.oix,s[13]=t.objid.oix>>8&255,s[14]=t.objid.oix>>16&255,s[15]=t.objid.oix>>24&255,s[16]=255&t.offset,s[17]=t.offset>>8&255,s[18]=t.offset>>16&255,s[19]=t.offset>>24&255,s[20]=255&t.body,s[21]=t.body>>8&255,s[22]=t.body>>16&255,s[23]=t.body>>24&255,s[24]=255&t.size,s[25]=t.size>>8&255,s[26]=t.size>>16&255,s[27]=t.size>>24&255,s[28]=255&t.flags,s[29]=t.flags>>8&255,s[30]=t.flags>>16&255,s[31]=t.flags>>24&255,this.pending[this.next_id]=new PendingData(n,i),this.debug&&console.log("Sending getObject",this.next_id,oid.vid,oid.oix),this.ws.send(s),this.next_id++},this.getObjectFromName=function(t,e,n,i){var s=new Uint8Array(10+t.length);s[0]=q,s[2]=255&this.next_id,s[3]=this.next_id>>8&255,s[4]=this.next_id>>16&255,s[5]=this.next_id>>24&255,s[6]=255&e,s[7]=e>>8&255,s[8]=255&t.length,s[9]=t.length>>8&255;for(var a=10,o=0;o<t.length;o++)s[a++]=t.charCodeAt(o);this.pending[this.next_id]=new PendingData(n,i),this.debug&&console.log("Sending getObjectFromName",this.next_id,t),this.ws.send(s),this.next_id++},this.crrSignal=function(t,e,n){var i=new Uint8Array(14);i[0]=F,i[2]=255&this.next_id,i[3]=this.next_id>>8&255,i[4]=this.next_id>>16&255,i[5]=this.next_id>>24&255,i[6]=255&t.vid,i[7]=t.vid>>8&255,i[8]=t.vid>>16&255,i[9]=t.vid>>24&255,i[10]=255&t.oix,i[11]=t.oix>>8&255,i[12]=t.oix>>16&255,i[13]=t.oix>>24&255,this.pending[this.next_id]=new PendingData(e,n),this.debug&&console.log("Sending crrObject",this.next_id,t.vid,t.oix),this.ws.send(i),this.next_id++},this.getOpwindMenu=function(t,e,n){t.length;var i=new Uint8Array(8+t.length);i[0]=H,i[2]=255&this.next_id,i[3]=this.next_id>>8&255,i[4]=this.next_id>>16&255,i[5]=this.next_id>>24&255,i[6]=255&t.length,i[7]=t.length>>8&255;for(var s=8,a=0;a<t.length;a++)i[s++]=t.charCodeAt(a);this.pending[this.next_id]=new PendingData(e,n),this.debug&&console.log("Sending getOpwindMenu",this.next_id),this.ws.send(i),this.next_id++},this.login=function(t,e,n,i){var s=new Uint8Array(8+t.length+2+e.length);s[0]=Y,s[2]=255&this.next_id,s[3]=this.next_id>>8&255,s[4]=this.next_id>>16&255,s[5]=this.next_id>>24&255;var a=6;s[a]=255&t.length,s[a+1]=t.length>>8&255,a+=2;for(var o=0;o<t.length;o++)s[a++]=t.charCodeAt(o);s[a]=255&e.length,s[a+1]=e.length>>8&255,a+=2;for(o=0;o<e.length;o++)s[a++]=e.charCodeAt(o);this.pending[this.next_id]=new PendingData(n,i),this.debug&&console.log("Sending login",this.next_id),this.ws.send(s),this.next_id++},this.getMsg=function(t,e,n){var i=new Uint8Array(10);i[0]=W,i[2]=255&this.next_id,i[3]=this.next_id>>8&255,i[4]=this.next_id>>16&255,i[5]=this.next_id>>24&255,i[6]=255&t,i[7]=t>>8&255,i[8]=t>>16&255,i[9]=t>>24&255,this.pending[this.next_id]=new PendingData(e,n),this.ws.send(i),this.debug&&console.log("Sending getMsg",this.next_id,t),this.next_id++},this.mhSync=function(t,e,n){var i=new Uint8Array(10);i[0]=Z,i[2]=255&this.next_id,i[3]=this.next_id>>8&255,i[4]=this.next_id>>16&255,i[5]=this.next_id>>24&255,i[6]=255&t,i[7]=t>>8&255,i[8]=t>>16&255,i[9]=t>>24&255,this.pending[this.next_id]=new PendingData(e,n),this.debug&&console.log("Sending mhSync",this.next_id),this.ws.send(i),this.next_id++},this.mhAcknowledge=function(t,e,n){var i=new Uint8Array(16+t.birthTime.length);i[0]=$,i[2]=255&this.next_id,i[3]=this.next_id>>8&255,i[4]=this.next_id>>16&255,i[5]=this.next_id>>24&255,i[6]=255&t.nix,i[7]=t.nix>>8&255,i[8]=t.nix>>16&255,i[9]=t.nix>>24&255,i[10]=255&t.idx,i[11]=t.idx>>8&255,i[12]=t.idx>>16&255,i[13]=t.idx>>24&255;var s=14;i[s]=255&t.birthTime.length,i[s+1]=t.birthTime.length>>8&255,s+=2;for(var a=0;a<t.birthTime.length;a++)i[s++]=t.birthTime.charCodeAt(a);this.pending[this.next_id]=new PendingData(e,n),this.debug&&console.log("Sending mhAcknowledge",this.next_id),console.log("Sending mhAcknowledge",this.next_id),this.ws.send(i),this.next_id++}}var Bitmaps={leaf:0,map:2,openmap:4,object:6,attrenum:8,attrarra:10,attrarel:12,attr:14,crrwrite:16,crrread:18,ack:20,alarm:22,eventacked:24,eventalarm:26,eventreturn:28,info:30,system:32,maintenance:34,blockl:36,blockr:38,img:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],pending:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],images:["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAMCAYAAABSgIzaAAAASElEQVQokWP4jwMwMDBgYBR5XBpwGYZVIzYNGDZB+QyEFOBiM+CyCacGBI0hgEGjsxkYGCiwkSI/4tKMz0DqxCM2A4hOOcQCAObFEQyI2PpKAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAMCAYAAABSgIzaAAAAQUlEQVQokWNgYGD4jw1jA2hqsGvAZRhWjdg0oIsh8QkqwMXGbhMuDXAxdAFsNDobyifTRor8SFGoUhSPFKUcYjEAMsMz2y6w8kgAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAMCAYAAABSgIzaAAAAKElEQVQokWP4DwUMDAwYGB9gwKUQm0FoGL/JOGwb1TgINZKFSbYOCgD1JxQJG0vK9AAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAMCAYAAABSgIzaAAAAK0lEQVQokWNgYGD4z8DA8B8bgMlhxbgUEgIMBE3Ggkc1Dk6N5AAGUm2DYQAkYTDe0vu7CAAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAMCAYAAABSgIzaAAAAQklEQVQokaXOwQ4AIAgCUP7/p+nUlpMSzY2bDwWHA5IEkFJCtaiKxE7dvsue8HZNJEPneoAuSq+OYAf9wy4K0Mk5C+d++RWimsw3AAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAMCAYAAABSgIzaAAAAPUlEQVQokaXRQQoAQAgCQP//6brKZmSt0M2hIACI4yBURqiKXQp0ThuhGwmt7Vy00XvqCa7QN1wjhtYLCCYyCkvDVnkJOQAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAH0lEQVQokWP4TyJgYGBg+E8iZiDFdHrZMKqBGA2kYAD8gaJsjwzf9wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAIklEQVQokWNgYGD4TxL+TyJg+P//P9GmwzXQ3oZRDdSOBwAGOSrkrXppgQAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAMCAYAAABSgIzaAAAAPklEQVQokWP4////fwYGBgxMCDBgU4jNICyYsOlYbENoJNIW7BqJsYm2NuJyBVE2EqWRfjbiUoQ3oAgpwgUANLqccvbgec0AAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAMCAYAAABSgIzaAAAAPElEQVQokWNgYGD4jw0wMDDgx9gUEgMYiDIdDaNoJBZg1UiUTTS1EZcriLKRKI30sxGXIgKBhF8RrqgBAOTOqGZ5aiCnAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAMCAYAAABSgIzaAAAAMElEQVQokWP4////fwYGBgxMCDBgU4jNICwYv+nY5InWOGojXW0khLEahtc6PDYCAB9hxkjBPICvAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAMCAYAAABSgIzaAAAALUlEQVQokWNgYGD4jw0wMDDgx9gUEgMYCJmOTZ5ojaM20tVGQgCHK/AnLVwAAPonfpBwU5f4AAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAIklEQVQokWP4////fwYGBpwYHTDANGADeDWM2jAEbSAFAADB26JsIjYj1AAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAIElEQVQokWNgYGD4jw8wMDCgYwZcEvg1jNowBG0gBQMAQN8q5COZl1cAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAIUlEQVQokWP4TyJgGIQaGBgY/pOIibcEroEkTLIfhoEGADzs8B5gcUg/AAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAJUlEQVQokWNgYGD4TyIedBr+kwgY/v//T7TpcA0k2TAIQ4nmGgDFzt0jExR7hgAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAN0lEQVQokaWNQQoAMAjD8v9P633WVWhBkJIotQQoYPYbrHYrqC9D+MG54OBMuMC54GApuPBed9OxiMNLGke1JwAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAANElEQVQokWNgYGD4jw3DABY57IqxsQlqwGELSYop1ECEYgo0EKmYQg1EKMbUQEAxRAMpAABRMgoFjbTzXgAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAPElEQVQokWNgYGD4j4yRATY5BmyKkGks4qgS2BSj2UYFDdgAdW2gvpOwhDW6ItwaCGI8JuHWgMOtWD0PACufaaWhXDFDAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAPElEQVQokWP4jwYYGBjgGKscNkXINLo4hgZsipFto44GbJi6NlDfSehhjUxjyGMVxQMYcJmEVwPB5ICEAdcbY6vf9TVAAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAS0lEQVQokZ2Q2w4AIAhCz///ND11M3RVmxuDUBRAtw8QHRyC4SSJSDjDht1Yhxdudks+bFNxYsX9G6rz2qVHxqRspGi2Wpoji/dqaLh22DbO2VuXAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAASklEQVQokWP4////fwYGBqIwVC2cgSKBTQzKxhDA0ICmGau12BRCMLJp2BQgy8H9gM9ELGJkasAXvFg9TQjgDCVc8YBXAwFMmgYASkT1C9E5Ya0AAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAARklEQVQokZ2QQQoAMAjD+v9Pu9PA1ThQQRBtoFUBJSkk0SlwOwKykCAEcn+BK8hih/aAe++y7IDuhWgXfcKHCuBBfX6ASR3Vn8ZINQzCrQAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAQ0lEQVQokWNgYGD4j45hAJscA8UakBXi0ITddDy2YJqOrBiLJjI1oLsdj1/I0IAnCLFpwtSALYQwNKB7FJ2NooEUDAAtGwcI+Svs4gAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAL0lEQVQokWP4TyJgGCkaGBgQyhhwSeASw9CAYho2A3CZiE0xVg34FOPUgA+QrAEA1FYi+tWeG/cAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAMElEQVQokWNgYGD4TyIeGRr+//+PXQOaBC4xVElkBdgMwHASTBEOxdj9gEcxHYIVAC5kqlZXl5JMAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAJ0lEQVQokWP4jwMwMDBgF8elGIZHNeDSANOEVRyXBpwGUcUGqvoBAK+H8xt0qXFWAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAJ0lEQVQokWNgYGD4jw3///8fqzgDLsUwMKoBlwaSg5UAHoiIw2cDAFMz2iY65DAoAAAAAElFTkSuQmC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAASUlEQVQokZ2RUQoAIAjFdv9L11dhskeUEIQ2mcYIAXjeisA+EahFA9ad/siAA0wqSUsnu87wDZh3VEodO6Rr1c51rc8fd9OoMQHLk7dXak3qLwAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAR0lEQVQokZ2S2woAIAhD9/8/vV6tjgMNhLxMN1SSTGYb46JkfS2gJglQ/ncRAZ5JTCXQYsFRwxpAvFtKoeMvmoqDv1jc5DQONycV+bfOetgAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAOUlEQVQokWNgYGD4///////E0AwMDP8hPDQAk8QhjlMCuzg2G3AB6tlAez8MglAiCZNiw/////8DACmmtFrq9aGNAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAN0lEQVQokWP4////fwYGhv/E0FA2w390jCSJIc6ASwKnBmw24MLUs4H2fhgEoUQKIMkGBgaG/wDZFBj2pVi3HgAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAN0lEQVQokWNgYGD4TyJm+E8sgGugig3YxHFqwGcIQQ3obAwN6G7GawMuhVg1EFKMUwM+QJ+IAwDD1Gyi1EZc6gAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAO0lEQVQokWP4TyJg+P///38GBgaiMFwDVWzAJo5TA15DCGnAYKNrwHAzPhtwKcSqgZBinBqIigeaRhwAPuZgrlZXy70AAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAP0lEQVQokZWPQQoAMAzC8v9Pu8soDOxaBS82QkWNgPKTJ/BYsLekAOxfquwHWyfws6ED7OgtfNk9bAuTSGBJOufqnHIsmYkzAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAQUlEQVQokZWPQQ4AMAQE5/+f1kuTCkuROGAmADCVPsJsBfdCsX0u3N7sJFfXsAqW8BMaID+9gE3SJayEFo7CFwY7GtAw3ouVj50AAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAQElEQVQokZ2QQQ4AMAjC+v9Pu9MWl5AJ42a0IlKBgCIadgGgQ8imqo9D3zDBvJoyR+zwlWHS9SUHaOf4QOywtQCQGucn0g2dEQAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAOklEQVQokWNgYGD4Tyz+////fwZSFBOtAaoQQsM46JLY+HAbUEwgrJmwyZTZQJYfSAolmsQDWTENwwByoOYaWbAqegAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAPElEQVQokWP4jwMwMDBgF8enAZsmvBqw2cSARQBDIQqbGEUoaggpQBcj3Qay/IAN4AwlfBrIigeiNeACADpU5yeYXn+XAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAPElEQVQokWNgYGD4jw3///8fqzgDPg04NOG3AUMTugA2hWhqiFKEzCeoAF2MRBvI8gNJoUT1eCBaAy4MAMhm5hr5iTaWAAAAAElFTkSuQmCC"]},Plow={DRAWOFFSET:2,DEST_INTOLAST:0,DEST_INTOFIRST:1,DEST_AFTER:2,DEST_BEFORE:3,TREE_INDENTATION:1,OPEN_ATTRIBUTES:1,OPEN_CHILDREN:2,OPEN_CROSSREFERENCES:4,OPEN_ALL:7,COLOR_BLACK:1,COLOR_RED:2,COLOR_GRAY:3,COLOR_DARKGRAY:4,COLOR_LIGHTGRAY:5,COLOR_WHITE:6,COLOR_YELLOW:7,COLOR_GREEN:8,COLOR_LIGHTBLUE:9,COLOR_BLUE:10,COLOR_VIOLET:11,eEvent_MB1Click:0,eEvent_MB1ClickShift:1,eEvent_Key_Up:2,eEvent_Key_Down:3,eEvent_Key_Right:4,eEvent_Key_Left:5,eEvent_Key_ShiftRight:6,eEvent_Key_CtrlR:7,eEvent_Key_CtrlL:8,eEvent_Key_CtrlG:9,eEvent_ObjectDeleted:10,RELATIVE_POSITION:1,NEXT_RELATIVE_POSITION:2};function PlowGeometry(){this.ll_x=0,this.ll_y=0,this.ur_x=0,this.ur_y=0}function PlowNodeClass(t){this.a=new PlowArray(t),this.ctx=t,this.nc_name="",this.group=0,this.node_open=0,this.draw=function(t,e,n,i){this.a.draw(t,e,n,i)},this.insert=function(t){this.a.add(t)}}function PlowArray(a){this.a=[],this.ctx=a,this.add=function(t){this.a.push(t)},this.insertNode=function(t,e,n){var i=this.find(t);if(-1==i)if(null==e)switch(n){case Plow.DEST_INTOLAST:case Plow.DEST_AFTER:this.a.push(t),t.level=0;break;default:t.level=0,this.a.unshift(t)}else{var s=this.find(e);if(-1==s)return;switch(n){case Plow.DEST_INTOFIRST:s==this.a.length-1?this.a.push(t):this.a.splice(s+1,0,t),t.level=e.level+1;break;case Plow.DEST_INTOLAST:if(s==this.a.length-1)this.a.push(t);else{i=this.a.length;for(var a=s+1;a<this.a.length;a++)if(this.a[a].level<=e.level){i=a;break}i==this.a.length?this.a.push(t):this.a.splice(i,0,t)}t.level=e.level+1;break;case Plow.DEST_AFTER:if(s==this.a.length-1)this.a.push(t);else{for(a=i;a<this.a.length&&!(this.a[a].level<e.level);a++);this.a.splice(a,0,t)}t.level=e.level;break;case Plow.DEST_BEFORE:0<i&&i--,this.a.splice(i,0,t),t.level=e.level}}},this.remove=function(t){var e=this.find(t);-1!=e&&(this.ctx.event_cb(Plow.eEvent_ObjectDeleted,this.a[e+1],0,0),this.a.splice(e,1))},this.size=function(){return this.a.length},this.get=function(t){return this.a[t]},this.draw=function(t,e,n,i){for(var s=0;s<this.a.length;s++)this.a[s].draw(t,e,n,i)},this.set_borders=function(t){for(var e=0;e<this.a.length;e++)this.a[e].set_borders(t)},this.configure=function(){for(var t=0;t<this.a.length;t++)this.a[t].pos.x=1*this.a[t].level,this.a[t].pos.y=1*t},this.close_node=function(t){var e=this.find(t);if(-1!=e){var n,i=t.level;for(n=e+1;n<this.a.length&&!(this.a[n].level<=i);n++);var s=n;if(s!=e+1)for(n=e+1;n<s;n++)a.select_object==this.a[e+1]&&(a.select_object=null),this.ctx.event_cb(Plow.eEvent_ObjectDeleted,this.a[e+1],0,0),this.a.splice(e+1,1)}},this.get_parent_object=function(t){var e=this.find(t);if(-1==e)return null;for(var n=e;0<=n;n--)if(this.a[n].level<t.level)return this.a[n];return null},this.get_first_child=function(t){var e=this.find(t);return-1==e?null:this.a.length==e-1?null:this.a[e+1].level>t.level?this.a[e+1]:null},this.get_next_sibling=function(t){for(var e=!1,n=0;n<this.a.length;n++)if(this.a[n]!=t){if(e){if(this.a[n].level==t.level)return this.a[n];if(this.a[n].level<t.level)return null}}else e=!0;return null},this.get_next_object=function(t){for(var e=0;e<this.a.length;e++)if(this.a[e]==t)return e==this.a.length-1?null:this.a[e+1];return null},this.get_previous_object=function(t){for(var e=0;e<this.a.length;e++)if(this.a[e]==t)return 0==e?null:this.a[e-1];return null},this.get_first_object=function(){return 0==this.a.length?null:this.a[0]},this.get_last_object=function(){return 0==this.a.length?null:this.a[this.a.length-1]},this.find=function(t){for(var e=0;e<this.a.length;e++)if(this.a[e]==t)return e;return-1}}function PlowNode(i,t,e){this.ctx=i,this.userdata=null,this.OFFSET=2,this.x_right=0,this.x_left=0,this.y_high=0,this.y_low=0,this.nc=t,this.pos=new PlowPoint(i,0,0),this.n_name="",this.annotv=[],this.annotsize=[],this.pixmapv=[],this.trace_object="",this.trace_attribute="",this.trace_attr_type=0,this.highlight=!1,this.select=!1,this.invert=!1,this.level=e,this.node_open=!1,this.fill_color=0,this.p=0,this.old_value=0,this.first_scan=!0,this.relative_position=0,this.set_annotation=function(t,e){10<=t||(this.annotv[t]=e)},this.set_annotation_pixmap=function(t,e){10<=t||(this.pixmapv[t]=e)},this.draw_object=function(){this.draw(this.ctx.gdraw.gctx,null,null,!1)},this.draw=function(t,e,n,i){var s=this.x_left*this.ctx.zoom_factor,a=this.y_low*this.ctx.zoom_factor-1,o=(this.x_right-this.x_left)*this.ctx.zoom_factor,l=(this.y_high-this.y_low)*this.ctx.zoom_factor+2;t.fillStyle="white",this.select&&(t.fillStyle="lightblue"),t.fillRect(s,a,o,l),this.nc.draw(t,this.pos,this,this.highlight)},this.connect=function(){if(""!=this.trace_object&&""!=this.trace_attribute){var t=this.trace_attribute.indexOf("#");-1!=t&&(this.trace_attribute=this.trace_attribute.substring(0,t));var e=this.trace_object+"."+this.trace_attribute;this.p=i.gdh.refObjectInfo(e,this.trace_attr_type),console.log("connecting",e,this.p)}},this.scan=function(){if(0!=this.p){var t=i.gdh.getRefObjectInfo(this.p);if(this.first_scan)this.first_scan=!1;else if(t==this.old_value)return;this.highlight=!!t,this.old_value=t,this.draw_object()}},this.set_borders=function(){this.x_left=1e37,this.x_right=-1e37,this.y_low=1e37,this.y_high=-1e37,t.a.set_borders(this)},this.event_handler=function(t,e,n){return(e-this.ctx.offset_x)/this.ctx.zoom_factor>=this.x_left&&(e-this.ctx.offset_x)/this.ctx.zoom_factor<=this.x_right&&(n-this.ctx.offset_y)/this.ctx.zoom_factor>=this.y_low&&(n-this.ctx.offset_y)/this.ctx.zoom_factor<=this.y_high?(i.event_object=this,1):0},this.set_select=function(t){t?(this.select=!0,this.ctx.select_object=this):(this.select=!1,this.ctx.select_object==this&&(this.ctx.select_object=null)),t!=this.select&&this.draw_object()},this.set_invert=function(t){this.invert=t,this.draw_object()},this.set_userdata=function(t){this.userdata=t},this.get_userdata=function(){return this.userdata},this.in_icon=function(t,e){return t>=this.x_left*this.ctx.zoom_factor&&t<=(this.x_left+1.75)*this.ctx.zoom_factor},this.measure=function(){var t=new PlowGeometry;return t.ll_x=this.x_left*this.ctx.zoom_factor,t.ll_y=this.y_low*this.ctx.zoom_factor,t.ur_x=this.x_right*this.ctx.zoom_factor,t.ur_y=this.y_high*this.ctx.zoom_factor,t}}function PlowPoint(t,e,n){this.x=e,this.y=n,this.ctx=t}function PlowAnnot(t,e,n,i,s,a,o){this.RELATIVE_OFFSET=1,this.p=new PlowPoint(t,e,n),this.draw_type=s,this.text_size=i,this.annot_type=a,this.number=o,this.ctx=t,this.draw=function(t,e,n,i){if(null!=n&&null!=n.annotv[this.number]){var s=0,a=this.ctx.zoom_factor/this.ctx.base_zoom_factor*(this.text_size+4)-4;if(!(a<0)){switch(a){case 0:s=8;break;case 1:s=10;break;case 2:s=12;break;case 3:case 4:s=14;break;case 5:case 6:case 7:s=18;break;default:s=3*a}t.font=s+"px Arial",n.invert?t.fillStyle="white":t.fillStyle="black",i&&(t.fillStyle="red"),t.lineWidth=.5;var o=(this.p.x+e.x)*this.ctx.zoom_factor,l=(this.p.y+e.y)*this.ctx.zoom_factor-s/4;if(0!=(this.annot_type&Plow.RELATIVE_POSITION)){var h=(e.x+n.relative_position+this.RELATIVE_OFFSET)*this.ctx.zoom_factor;o<h&&(o=h)}for(var r=n.annotv[this.number].split("\n"),A=0;A<r.length;A++)t.fillText(r[A],o,l),l+=1.4*s;0==(this.annot_type&Plow.NEXT_RELATIVE_POSITION)&&0==(this.annot_type&Plow.RELATIVE_POSITION)||(n.relative_position=(o+t.measureText(n.annotv[this.number]).width)/this.ctx.zoom_factor-e.x)}}},this.set_borders=function(t){}}function PlowAnnotPixmap(t,e,n,i){this.p=new PlowPoint(t,e,n),this.number=i,this.ctx=t,this.draw=function(e,t,n,i){var s,a=(this.p.x+t.x)*this.ctx.zoom_factor,o=(this.p.y+t.y)*this.ctx.zoom_factor,l=n.pixmapv[this.number];null!=l&&(n.invert&&l++,null==(s=Bitmaps.img[l])?((s=new Image).src=Bitmaps.images[l],Bitmaps.img[l]=s,Bitmaps.pending[l]=[],Bitmaps.pending[l].push(new PlowPoint(this.ctx,a,o)),s.onload=function(){for(var t=0;t<Bitmaps.pending[l].length;t++)e.drawImage(s,Bitmaps.pending[l][t].x,Bitmaps.pending[l][t].y);Bitmaps.pending[l]=null}):s.complete?e.drawImage(s,a,o):Bitmaps.pending[l].push(new PlowPoint(this.ctx,a,o)))},this.set_borders=function(t){}}function PlowRect(t,e,n,i,s,a,o,l,h){this.ll=new PlowPoint(t,e,n),this.ur=new PlowPoint(t,e+i,n+s),this.border_color=o,this.fill_color=a,this.fill=l,this.fix_color=h,this.ctx=t,this.draw=function(t,e,n,i){var s=(this.ll.x+e.x)*this.ctx.zoom_factor,a=(this.ll.y+e.y)*this.ctx.zoom_factor,o=(this.ur.x-this.ll.x)*this.ctx.zoom_factor,l=(this.ur.y-this.ll.y)*this.ctx.zoom_factor;switch(t.lineWidth=1,this.border_color){case Plow.COLOR_GRAY:t.strokeStyle="grey";break;case Plow.COLOR_RED:t.strokeStyle="red";break;case Plow.COLOR_WHITE:t.strokeStyle="white";break;default:t.strokeStyle="black"}if(i&&(t.strokeStyle="red"),t.strokeRect(s,a,o,l),this.fill){switch(this.fill_color){case Plow.COLOR_GRAY:t.fillStyle="grey";break;case Plow.COLOR_RED:t.fillStyle="red";break;case Plow.COLOR_YELLOW:t.fillStyle="yellow";break;case Plow.COLOR_GREEN:t.fillStyle="lightgreen";break;case Plow.COLOR_WHITE:n.invert?t.fillStyle="black":t.fillStyle="white";break;default:n.invert?t.fillStyle="white":t.fillStyle="black"}t.fillRect(s,a,o,l)}},this.set_borders=function(t){this.ll.x+t.pos.x<t.x_left&&(t.x_left=this.ll.x+t.pos.x),this.ur.x+t.pos.x>t.x_right&&(t.x_right=this.ur.x+t.pos.x),this.ll.y+t.pos.y<t.y_low&&(t.y_low=this.ll.y+t.pos.y),this.ur.y+t.pos.y>t.y_high&&(t.y_high=this.ur.y+t.pos.y)}}function GDraw(t){this.ctx=t,this.canvas=document.querySelector("canvas"),this.gctx=this.canvas.getContext("2d"),this.offset_top=this.canvas.offsetTop}function PlowCtx(){this.gdh=0,this.debug=!1,this.nodraw=0,this.zoom_factor=20,this.base_zoom_factor=20,this.offset_x=0,this.offset_y=0,this.x_right=0,this.x_left=0,this.y_high=0,this.y_low=0,this.a=new PlowArray(this),this.a_nc=new PlowArray(this),this.name="Claes context",this.gdraw=new GDraw(this),this.selct_object=null,this.event_cb=null,this.event_object=null,this.draw=function(){0<this.nodraw||(this.gdraw.gctx.fillStyle="white",this.gdraw.gctx.fillRect(0,0,this.gdraw.canvas.width,this.gdraw.canvas.height),this.a.draw(this.gdraw.gctx,null,null,!1))},this.connect=function(){for(var t=0;t<this.a.size();t++)this.a.get(t).connect()},this.scan=function(){console.log("ctx scan",this.a.size());for(var t=0;t<this.a.size();t++)this.a.get(t).scan()},this.set_nodraw=function(){this.nodraw++},this.reset_nodraw=function(){this.nodraw--},this.size=function(){return this.a.size()},this.event_handler=function(t,e,n){var i=0;switch(t){case Plow.eEvent_MB1Click:case Plow.eEvent_MB1ClickShift:for(var s=0;s<this.a.size()&&!(this.a.get(s)instanceof PlowNode&&1==(i=this.a.get(s).event_handler(t,e,n)));s++);1==i&&(this.event_cb(t,this.event_object,e,n),this.draw());break;case Plow.eEvent_Key_Up:case Plow.eEvent_Key_Down:case Plow.eEvent_Key_Left:case Plow.eEvent_Key_Right:case Plow.eEvent_Key_ShiftRight:case Plow.eEvent_Key_CtrlR:case Plow.eEvent_Key_CtrlL:case Plow.eEvent_Key_CtrlG:this.event_cb(t,null,0,0)}},this.set_select=function(t){for(var e=0;e<this.a.size();e++)this.a.get(e)instanceof PlowNode&&this.a.get(e).set_select(t)},this.set_invert=function(t){for(var e=0;e<this.a.size();e++)this.a.get(e)instanceof PlowNode&&this.a.get(e).set_invert(t)},this.get_select=function(){return this.select_object},this.insert=function(t,e){this.a.add(t)},this.insertNode=function(t,e,n){this.a.insertNode(t,e,n)},this.remove=function(t){this.select_object==t&&(this.select_object=null),this.a.remove(t)},this.insert_nc=function(t){this.a_nc.add(t)},this.configure=function(){this.a.configure(),this.a.set_borders();var t=1*this.a.a.length*this.zoom_factor;this.gdraw.canvas.height=t},this.get_parent_object=function(t){return this.a.get_parent_object(t)},this.get_next_object=function(t){return this.a.get_next_object(t)},this.get_last_object=function(){return this.a.get_last_object()},this.get_first_object=function(){return this.a.get_first_object()},this.get_previous_object=function(t){return this.a.get_previous_object(t)},this.close_node=function(t){this.a.close_node(t)},this.is_visible=function(t){return t.y_high*this.zoom_factor<=window.pageYOffset+window.innerHeight-this.gdraw.offset_top&&t.y_low*this.zoom_factor>=window.pageYOffset-this.gdraw.offset_top},this.scroll=function(t,e){window.scrollTo(window.scrollX,t*this.zoom_factor-window.innerHeight*e+this.gdraw.offset_top)}}function EvOpenChildrenData(t,e){this.node=t,this.open_next=e}var EvC={eType_AlarmList:0,eType_EventList:1,eType_BlockList:2};function Ev(){this.ctx=null,this.ncAlarmA=null,this.ncAlarmB=null,this.ncAlarm=null,this.ncInfo=null,this.ncSuccess=null,this.scan_update,this.priv=0,this.mhSyncIdx=0,this.type=EvC.eType_AlarmList,this.ala=null,this.maxEve=30,this.maxAla=30;var h=this;this.init=function(){switch(this.type=this.get_type(),this.type){case EvC.eType_EventList:document.title="Event List"}this.priv=sessionStorage.getItem("pwr_privilege"),console.log("pwr_privilege",this.priv),this.methods_init(),this.ctx=new PlowCtx,this.ctx.event_cb=this.plow_event,this.createNodeClasses(),this.ctx.gdh=new Gdh,this.ctx.gdh.open_cb=this.gdh_init_cb,this.ctx.gdh.init(),this.ctx.gdraw.canvas.addEventListener("click",function(t){var e=t.pageY-h.ctx.gdraw.offset_top,n=t.pageX;t.shiftKey?ev.ctx.event_handler(Plow.eEvent_MB1ClickShift,n,e):ev.ctx.event_handler(Plow.eEvent_MB1Click,n,e)}),document.addEventListener("keydown",function(t){40==t.keyCode?(h.ctx.event_handler(Plow.eEvent_Key_Down),t.preventDefault()):39==t.keyCode?(t.shiftKey?h.ctx.event_handler(Plow.eEvent_Key_ShiftRight):h.ctx.event_handler(Plow.eEvent_Key_Right),t.preventDefault()):37==t.keyCode?(h.ctx.event_handler(Plow.eEvent_Key_Left),t.preventDefault()):38==t.keyCode?(h.ctx.event_handler(Plow.eEvent_Key_Up),t.preventDefault()):82==t.keyCode?(t.ctrlKey&&h.ctx.event_handler(Plow.eEvent_Key_CtrlR),t.preventDefault()):76==t.keyCode?(t.ctrlKey&&h.ctx.event_handler(Plow.eEvent_Key_CtrlL),t.preventDefault()):71==t.keyCode&&(t.ctrlKey&&h.ctx.event_handler(Plow.eEvent_Key_CtrlG),t.preventDefault())}),document.getElementById("toolitem1").addEventListener("click",function(t){console.log("Ack"),h.ack()}),document.getElementById("toolitem2").addEventListener("click",function(t){var e=h.ctx.get_select();null!=e&&(console.log("toolitem2",e.userdata.e.supObject.vid,e.userdata.e.supObject.oix),h.ctx.gdh.getObjectFromAref(e.userdata.e.supObject,GdhOp.GET_OP_SELF,h.open_navigator_cb,null),console.log("toolitem2 event"))}),document.getElementById("toolitem3").addEventListener("click",function(t){console.log("toolitem5 event");var e=h.ctx.get_select();if(null!==e){var n=window.open("","_blank");h.ctx.gdh.getObjectFromAref(e.userdata.e.supObject,GdhOp.GET_OP_METHOD_PLC,h.open_plc_cb,n)}}),document.getElementById("toolitem4").addEventListener("click",function(t){var e=h.ctx.get_select();if(e.userdata instanceof EvItemAlarm){var n=window.open("","_blank");h.ctx.gdh.getObjectFromName(e.userdata.e.eventName,GdhOp.GET_OP_METHOD_GRAPH,h.open_graph_cb,n)}}),document.getElementById("toolitem5").addEventListener("click",function(t){var e=h.ctx.get_select();if(e.userdata instanceof EvItemAlarm){var n=window.open("","_blank");h.ctx.gdh.getObjectFromName(e.userdata.e.eventName,GdhOp.GET_OP_METHOD_OBJECTGRAPH,h.open_graph_cb,n)}}),document.getElementById("toolitem6").addEventListener("click",function(t){var e=h.ctx.get_select();console.log("storage",localStorage.getItem("XttMethodNavigator")),localStorage.setItem("XttMethodNavigator",e.userdata.e.eventName),console.log("storage",localStorage.getItem("XttMethodNavigator")),console.log("toolitem6 event window",window.opener),window.opener.focus()}),document.getElementById("toolitem7").addEventListener("click",function(t){var e=h.ctx.get_select();if(null!==e){var n=window.open("","_blank");h.ctx.gdh.getObjectFromName(e.userdata.e.eventName,GdhOp.GET_OP_METHOD_PLC,h.open_plc_cb,n),console.log("toolitem7 event")}}),document.getElementById("toolitem8").addEventListener("click",function(t){console.log("toolitem8 event")}),document.getElementById("toolitem9").addEventListener("click",function(t){console.log("toolitem9 event");var e=h.ctx.get_select();null!==e&&e.userdata.open_attributes(h)}),document.getElementById("toolitem10").addEventListener("click",function(t){var e=h.ctx.get_select();null!==e&&(h.ctx.gdh.crrSignal(e.userdata.e.eventName,h.open_crr_cb,e),console.log("toolitem10 event"))}),document.getElementById("toolitem11").addEventListener("click",function(t){console.log("toolitem11 event")}),document.getElementById("toolitem12").addEventListener("click",function(t){console.log("toolitem12 event");var e=h.ctx.get_select();if(null!=e&&e.userdata instanceof EvItemAlarm){var n=window.open("","_blank");h.ctx.gdh.getObjectFromName(e.userdata.e.eventName,GdhOp.GET_OP_METHOD_HELPCLASS,h.open_helpclass_cb,n)}})},this.is_authorized=function(t){return!!(this.priv&t)},this.gdh_init_cb=function(){null==h.priv&&h.ctx.gdh.login("","",h.login_cb,h),h.ctx.gdh.listSent=!0,h.trace_cyclic()},this.login_cb=function(t,e,n,i){console.log("Login:",n,i),h.priv=1&n?i:0},this.sync_cb=function(t,e,n,i){if(1&n&&0!==i.length)if(h.type==EvC.eType_AlarmList){h.ctx.set_nodraw();for(var s=i.length-1;0<=s;s--){switch((l=i[s]).eventType){case MhC.eEvent_Alarm:case MhC.eEvent_MaintenanceAlarm:case MhC.eEvent_SystemAlarm:case MhC.eEvent_UserAlarm1:case MhC.eEvent_UserAlarm2:case MhC.eEvent_UserAlarm3:case MhC.eEvent_UserAlarm4:case MhC.eEvent_Info:case MhC.eEvent_InfoSuccess:if(h.ctx.size()>=h.maxEve){var a=h.ctx.get_last_object();h.ctx.remove(a)}new EvItemAlarm(h,l,null,Plow.DEST_BEFORE);break;case MhC.eEvent_Ack:null!==(o=h.find_event(l.targetId))&&(o.e.eventStatus&MhC.mEventStatus_NotRet?(o.e.eventStatus&=~MhC.mEventStatus_NotAck,o.update()):h.ctx.remove(o.node));break;case MhC.eEvent_Return:var o;null!==(o=h.find_event(l.targetId))&&(o.e.eventStatus&MhC.mEventStatus_NotAck?(o.e.eventStatus&=~MhC.mEventStatus_NotRet,o.update()):h.ctx.remove(o.node))}h.mhSyncIdx<i[s].syncIdx&&(h.mhSyncIdx=i[s].syncIdx)}h.ctx.configure(),h.ctx.reset_nodraw(),h.ctx.draw()}else if(h.type==EvC.eType_EventList){h.ctx.set_nodraw();for(s=i.length-1;0<=s;s--){var l=i[s];if(h.ctx.size()>=h.maxEve){a=h.ctx.get_last_object();h.ctx.remove(a)}new EvItemAlarm(h,l,null,Plow.DEST_BEFORE),h.mhSyncIdx<i[s].syncIdx&&(h.mhSyncIdx=i[s].syncIdx)}h.ctx.configure(),h.ctx.reset_nodraw(),h.ctx.draw()}},this.find_event=function(t){for(var e=this.ctx.get_first_object();null!==e;e=this.ctx.get_next_object(e)){var n=e.get_userdata();if(n.e.eventId.nix==t.nix&&n.e.eventId.idx==t.idx)return n}return null},this.is_authorized=function(t){return!!(this.priv&t)},this.ack=function(){if(this.is_authorized(Pwr.mAccess_RtEventsAck)){var t=this.ctx.get_first_object();if(null!==t){var e=t.get_userdata();console.log("Ack",e.e.eventText),this.ctx.gdh.mhAcknowledge(e.e.eventId,this.ack_cb,this),e.e.eventStatus&MhC.mEventStatus_NotRet?(e.e.eventStatus&=~MhC.mEventStatus_NotAck,e.update()):this.ctx.remove(e.node),this.ctx.configure(),this.ctx.draw()}}else window.alert("Not authorzed for this operation")},this.ack_cb=function(t,e,n){console.log("ack sts",n)},this.open_objectgraph_cb=function(t,e,n,i){0!=(1&n)?(e.location.href="ge.html?graph="+i.param1+"&instance="+i.fullname,e.document.title=i.fullname):e.document.write("Error status "+n)},this.open_graph_cb=function(t,e,n,i){if(0!=(1&n)){var s=i.param1.indexOf(".");-1!=s&&(i.param1=i.param1.substring(0,s));var a="";""!==i.fullname&&(a="&instance="+i.fullname),e.location.href="ge.html?graph="+i.param1+a,e.document.title=i.param1}else e.document.write("Error status "+n)},this.open_plc_cb=function(t,e,n,i){var s;0!=(1&n)?(s=""!==i.param1?"&obj="+i.param1:"",console.log("flow.html?vid="+i.objid.vid+"&oix="+i.objid.oix+s),e.location.href="flow.html?vid="+i.objid.vid+"&oix="+i.objid.oix+s,e.document.title="Trace "+i.fullname):e.document.write("Error status "+n)},this.open_navigator_cb=function(t,e,n,i){console.log("Open navigator",n),0!=(1&n)?(localStorage.setItem("XttMethodNavigator",i.fullname),console.log("storage",localStorage.getItem("XttMethodNavigator"))):console.log("Error status "+n)},this.open_objectgraph_cb=function(t,e,n,i){if(0!=(1&n)){var s=i.classname.toLowerCase();"$"==s.substring(0,1)&&(s=s.substring(1));var a="pwr_c_"+s;e.location.href="ge.html?graph="+a+"&instance="+i.fullname,e.document.title=a+" "+i.fullname}else e.document.write("Error status "+n)},this.open_helpclass_cb=function(t,e,n,i){if(0!=(1&n)){console.log("open_helpclass",i.param1);var s=location.protocol+"//"+location.host+i.param1;e.location.href=s}else e.document.write("Error status "+n)},this.methods_init=function(){localStorage.setItem("EvMethodNavigator","")},this.collapse=function(){this.ctx.set_nodraw();for(var t=0;t<this.ctx.a.size();t++){var e=this.ctx.a.get(t);0==e.level&&e.userdata.close(this)}this.ctx.reset_nodraw(),this.ctx.draw()},this.trace_cyclic=function(){h.ctx.gdh.mhSync(h.mhSyncIdx,h.sync_cb,h),h.timer=setTimeout(h.trace_cyclic,1e3)},this.trace_scan=function(t,e){h.scan_update=!1,h.scan_update&&h.ctx.draw()},this.createNodeClasses=function(){var t=new PlowRect(this.ctx,0,0,50,1,Plow.COLOR_WHITE,Plow.COLOR_WHITE,!0,!1),e=new PlowRect(this.ctx,.1,.15,.7,.7,Plow.COLOR_RED,Plow.COLOR_BLACK,!0,!1),n=new PlowRect(this.ctx,.1,.15,.7,.7,Plow.COLOR_YELLOW,Plow.COLOR_BLACK,!0,!1),i=new PlowRect(this.ctx,.1,.15,.7,.7,Plow.COLOR_WHITE,Plow.COLOR_BLACK,!0,!1),s=new PlowRect(this.ctx,.1,.15,.7,.7,Plow.COLOR_GREEN,Plow.COLOR_BLACK,!0,!1),a=new PlowAnnot(this.ctx,1,.9,4,Plow.COLOR_BLACK,0,0),o=new PlowAnnotPixmap(this.ctx,1.8,.2,0),l=new PlowAnnotPixmap(this.ctx,2.4,.2,1),h=new PlowAnnotPixmap(this.ctx,3.2,.2,2),r=new PlowAnnotPixmap(this.ctx,4,.2,3),A=new PlowAnnot(this.ctx,4.8,.9,4,Plow.COLOR_BLACK,0,1),c=new PlowAnnot(this.ctx,11.5,.9,4,Plow.COLOR_BLACK,Plow.NEXT_RELATIVE_POSITION,2),g=new PlowAnnot(this.ctx,22.5,.9,4,Plow.COLOR_BLACK,Plow.RELATIVE_POSITION,3);this.ncAlarmA=new PlowNodeClass(this.ctx),this.ncAlarmA.insert(t),this.ncAlarmA.insert(e),this.ncAlarmA.insert(a),this.ncAlarmA.insert(o),this.ncAlarmA.insert(l),this.ncAlarmA.insert(h),this.ncAlarmA.insert(r),this.ncAlarmA.insert(A),this.ncAlarmA.insert(c),this.ncAlarmA.insert(g),this.ctx.insert_nc(this.ncAlarmA),this.ncAlarmB=new PlowNodeClass(this.ctx),this.ncAlarmB.insert(t),this.ncAlarmB.insert(n),this.ncAlarmB.insert(a),this.ncAlarmB.insert(o),this.ncAlarmB.insert(l),this.ncAlarmB.insert(h),this.ncAlarmB.insert(r),this.ncAlarmB.insert(A),this.ncAlarmB.insert(c),this.ncAlarmB.insert(g),this.ctx.insert_nc(this.ncAlarmB),this.ncAlarm=new PlowNodeClass(this.ctx),this.ncAlarm.insert(t),this.ncAlarm.insert(a),this.ncAlarm.insert(o),this.ncAlarm.insert(l),this.ncAlarm.insert(h),this.ncAlarm.insert(r),this.ncAlarm.insert(A),this.ncAlarm.insert(c),this.ncAlarm.insert(g),this.ctx.insert_nc(this.ncAlarm),this.ncInfo=new PlowNodeClass(this.ctx),this.ncInfo.insert(t),this.ncInfo.insert(i),this.ncInfo.insert(a),this.ncInfo.insert(o),this.ncInfo.insert(l),this.ncInfo.insert(h),this.ncInfo.insert(r),this.ncInfo.insert(A),this.ncInfo.insert(c),this.ncInfo.insert(g),this.ctx.insert_nc(this.ncInfo),this.ncSuccess=new PlowNodeClass(this.ctx),this.ncSuccess.insert(t),this.ncSuccess.insert(s),this.ncSuccess.insert(a),this.ncSuccess.insert(o),this.ncSuccess.insert(l),this.ncSuccess.insert(h),this.ncSuccess.insert(r),this.ncSuccess.insert(A),this.ncSuccess.insert(c),this.ncSuccess.insert(g),this.ctx.insert_nc(this.ncSuccess)},this.plow_event=function(t,e,n,i){var s=null;switch(null!=e&&(s=e.get_userdata()),t){case Plow.eEvent_ObjectDeleted:break;case Plow.eEvent_MB1Click:null!=s&&""!==s.e.eventMoreText&&n>=e.measure().ll_x+70&&n<=e.measure().ll_x+90?window.alert(s.e.eventMoreText):e.select?(e.set_select(!1),e.set_invert(!1)):(h.ctx.set_select(!1),e.set_select(!0),h.ctx.set_invert(!1),e.set_invert(!0),h.ctx.draw());break;case Plow.eEvent_MB1ClickShift:break;case Plow.eEvent_Key_Down:if(null!=(l=h.ctx.get_select()))null!=(a=h.ctx.get_next_object(l))&&(l.set_select(!1),l.set_invert(!1),a.set_select(!0),a.set_invert(!0),h.ctx.is_visible(a)||h.ctx.scroll(a.y_low,.1));else(l=h.ctx.a.a[0]).set_select(!0),l.set_invert(!0);break;case Plow.eEvent_Key_Up:var a;if(null!=(l=h.ctx.get_select()))null!=(a=h.ctx.get_previous_object(l))&&(l.set_select(!1),l.set_invert(!1),a.set_select(!0),a.set_invert(!0),l.draw(h.ctx.gdraw.gctx,null,null,0),a.draw(h.ctx.gdraw.gctx,null,null,0),h.ctx.is_visible(a)||h.ctx.scroll(a.y_low,.9));break;case Plow.eEvent_Key_Right:case Plow.eEvent_Key_Left:case Plow.eEvent_Key_ShiftRight:case Plow.eEvent_Key_CtrlR:break;case Plow.eEvent_Key_CtrlL:if((l=h.ctx.get_select()).userdata instanceof EvItemAlarm){var o=window.open("","_blank");h.ctx.gdh.getObject(l.userdata.objid,GdhOp.GET_OP_METHOD_PLC,h.open_plc_cb,o)}break;case Plow.eEvent_Key_CtrlG:var l;if((l=h.ctx.get_select()).userdata instanceof EvItemAlarm){o=window.open("","_blank");h.ctx.gdh.getObject(l.userdata.objid,GdhOp.GET_OP_METHOD_PLC,h.open_objectgraph_cb,o)}}},this.get_type=function(){var t=window.location.search.substring(1);if(""===t)return EvC.eType_AlarmList;var e=t.split("&")[0].substring(5);return"event"==e?EvC.eType_EventList:"block"==e?EvC.eType_BlockList:EvC.eType_AlarmList}}function EvItemAlarm(t,e,n,i){this.node,this.e=e;var s=t.ncAlarm;switch(this.e.eventType){case MhC.eEvent_Alarm:case MhC.eEvent_MaintenanceAlarm:case MhC.eEvent_SystemAlarm:case MhC.eEvent_UserAlarm1:case MhC.eEvent_UserAlarm2:case MhC.eEvent_UserAlarm3:case MhC.eEvent_UserAlarm4:case MhC.eEvent_Block:case MhC.eEvent_Reblock:case MhC.eEvent_CancelBlock:case MhC.eEvent_Unblock:switch(this.e.eventPrio){case MhC.eEventPrio_A:s=t.ncAlarmA;break;case MhC.eEventPrio_B:s=t.ncAlarmB;break;case MhC.eEventPrio_C:case MhC.eEventPrio_D:s=t.ncAlarm}break;case MhC.eEvent_Info:s=t.ncInfo;break;case MhC.eEvent_InfoSuccess:s=t.ncSuccess}switch(this.node=new PlowNode(t.ctx,s,0),t.ctx.insertNode(this.node,n,i),this.node.set_userdata(this),this.e.eventType){case MhC.eEvent_Alarm:case MhC.eEvent_MaintenanceAlarm:case MhC.eEvent_SystemAlarm:case MhC.eEvent_UserAlarm1:case MhC.eEvent_UserAlarm2:case MhC.eEvent_UserAlarm3:case MhC.eEvent_UserAlarm4:case MhC.eEvent_Block:case MhC.eEvent_Reblock:case MhC.eEvent_CancelBlock:case MhC.eEvent_Unblock:switch(this.e.eventPrio){case MhC.eEventPrio_A:this.node.set_annotation(0,"A");break;case MhC.eEventPrio_B:this.node.set_annotation(0,"B");break;case MhC.eEventPrio_C:this.node.set_annotation(0,"C");break;case MhC.eEventPrio_D:this.node.set_annotation(0,"D")}}switch(this.e.eventType){case MhC.eEvent_MaintenanceAlarm:this.node.set_annotation_pixmap(3,Bitmaps.maintenance);break;case MhC.eEvent_SystemAlarm:this.node.set_annotation_pixmap(3,Bitmaps.system);break;case MhC.eEvent_Block:this.e.eventText="Blocked";break;case MhC.eEvent_Reblock:this.e.eventText="Reblocked";break;case MhC.eEvent_CancelBlock:this.e.eventText="Block canceled";break;case MhC.eEvent_Unblock:this.e.eventText="Unblocked"}switch(this.node.set_annotation(1,this.e.eventTime.substring(0,17)),this.node.set_annotation(2,this.e.eventText),this.node.set_annotation(3,this.e.eventName),t.type){case EvC.eType_EventList:switch(this.e.eventType){case MhC.eEvent_Alarm:case MhC.eEvent_MaintenanceAlarm:case MhC.eEvent_SystemAlarm:case MhC.eEvent_UserAlarm1:case MhC.eEvent_UserAlarm2:case MhC.eEvent_UserAlarm3:case MhC.eEvent_UserAlarm4:case MhC.eEvent_Info:case MhC.eEvent_InfoSuccess:this.node.set_annotation_pixmap(0,Bitmaps.eventalarm);break;case MhC.eEvent_Ack:this.node.set_annotation_pixmap(0,Bitmaps.eventacked);break;case MhC.eEvent_Return:this.node.set_annotation_pixmap(0,Bitmaps.eventreturn);break;case MhC.eEvent_Block:case MhC.eEvent_Reblock:this.node.set_annotation_pixmap(0,Bitmaps.blockl);break;case MhC.eEvent_CancelBlock:case MhC.eEvent_Unblock:this.node.set_annotation_pixmap(0,Bitmaps.blockr)}break;case EvC.eType_AlarmList:this.e.eventStatus&MhC.mEventStatus_NotRet&&this.node.set_annotation_pixmap(1,Bitmaps.alarm),this.e.eventStatus&MhC.mEventStatus_NotAck&&this.node.set_annotation_pixmap(0,Bitmaps.ack),""!==this.e.eventMoreText&&this.node.set_annotation_pixmap(2,Bitmaps.info)}this.update=function(){this.e.eventStatus&MhC.mEventStatus_NotRet?this.node.set_annotation_pixmap(1,Bitmaps.alarm):this.node.set_annotation_pixmap(1,null),this.e.eventStatus&MhC.mEventStatus_NotAck?this.node.set_annotation_pixmap(0,Bitmaps.ack):this.node.set_annotation_pixmap(0,null)}}var ev=new Ev;ev.init();